!function(a){var b=function(a,b){this.done=!1,this.xhr=a;var c=this;this.abort=function(){this.done||(this.xhr.abort(),this.done=!0,h("abort",i))},this.xhr.onreadystatechange=function(){4==c.xhr.readyState&&(c.done=!0,b(c.xhr.status))}},c="/api",d="",e="fr-FR",f=function(a,b){console.log("[API]["+a+"] "+b),h("error",a,b)},g={error:[],loading:[],loaded:[],abort:[]},h=function(a,b,c,d){if(!g.hasOwnProperty(a))return!1;for(var e=0;e<g[a].length;e++)g[a][e](b,c,d);return!0},i={};i.setLang=function(a){e=a},i.setToken=function(a){d=a};var j=function(a,b){var c=[],d=0;if(b.constructor===Array){for(d=0;d<b.length;d++)b.hasOwnProperty(d)&&c.push(j(a+"["+d+"]",b[d]));return c.join("&")}if("object"==typeof b){for(d in b)b.hasOwnProperty(d)&&c.push(j(a+"["+d+"]",b[d]));return c.join("&")}return a+"="+encodeURIComponent(b+"")};i.call=function(a,g,k,l){k||(k={}),"object"!=typeof l&&(l={any:l}),"/"!=g.substr(0,1)&&(g="/"+g),h("loading",i);var m;m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var n=c+g;if("GET"==a){var o=[];for(var p in k)o.push(j(p,k[p]));o.length&&(n+="?"+o.join("&"))}m.open(a,n,!0),m.setRequestHeader("Content-Type","application/json"),m.setRequestHeader("Accept","application/json"),m.setRequestHeader("X-Token",d),m.setRequestHeader("X-Lang",e),"GET"==a?m.send():m.send(JSON.stringify(k));var o=null;return function(a){o=new b(a,function(b){h("loaded",i);var c=JSON.parse(a.responseText);c.error&&c.error_message&&f(c.error,c.error_message);var d=a.getResponseHeader("X-Token");d&&i.setToken(d),l.hasOwnProperty(b)?l[b](c):l.hasOwnProperty("any")&&l.any(c)})}(m),o},i.get=function(a,b,c){return i.call("GET",a,b,c)},i.post=function(a,b,c){return i.call("POST",a,b,c)},i.put=function(a,b,c){return i.call("PUT",a,b,c)},i.patch=function(a,b,c){return i.call("PATCH",a,b,c)},i.delete=function(a,b){return i.call("DELETE",a,{},b)},i.on=function(a,b){return!!g.hasOwnProperty(a)&&(g[a].push(b),!0)},a.api=i}(window);