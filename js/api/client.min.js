(function(g){var i=function(j,l){this.done=false;this.xhr=j;var k=this;this.abort=function(){if(this.done){return}this.xhr.abort();this.done=true;e("abort",b)};this.xhr.onreadystatechange=function(){if(k.xhr.readyState==4){k.done=true;l(k.xhr.status)}}};var h="/api";var d="";var a="fr-FR";var c=function(k,j){console.log("[API]["+k+"] "+j);e("error",k,j)};var f={error:[],loading:[],loaded:[],abort:[]};var e=function(k,n,m,l){if(!f.hasOwnProperty(k)){return false}for(var j=0;j<f[k].length;j++){f[k][j](n,m,l)}return true};var b={};b.setLang=function(j){a=j};b.setToken=function(j){d=j};b.call=function(o,n,l,k){if(!l){l={}}if(typeof k!="object"){k={any:k}}if(n.substr(0,1)!="/"){n="/"+n}e("loading",b);var j;if(window.XMLHttpRequest){j=new XMLHttpRequest()}else{j=new ActiveXObject("Microsoft.XMLHTTP")}j.open(o,h+n,true);j.setRequestHeader("Content-Type","application/json");j.setRequestHeader("Accept","application/json");j.setRequestHeader("X-Token",d);j.setRequestHeader("X-Lang",a);j.send(JSON.stringify(l));var m=null;(function(p){m=new i(p,function(s){e("loaded",b);var q=JSON.parse(p.responseText);if(q.error&&q.error_message){c(q.error,q.error_message)}var r=p.getResponseHeader("X-Token");if(r){b.setToken(r)}if(k.hasOwnProperty(s)){k[s](q)}else{if(k.hasOwnProperty("any")){k.any(q)}}})})(j);return m};b.get=function(l,k,j){b.call("GET",l,k,j)};b.post=function(l,k,j){b.call("POST",l,k,j)};b.put=function(l,k,j){b.call("PUT",l,k,j)};b.patch=function(l,k,j){b.call("PATCH",l,k,j)};b["delete"]=function(k,j){b.call("DELETE",k,{},j)};b.on=function(j,k){if(!f.hasOwnProperty(j)){return false}f[j].push(k);return true};g.api=b})(window);